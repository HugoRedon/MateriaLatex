\subsection{Entropía}

	El cálculo de la entropía es muy semejante al de la entalpía, es necesario conocer la entropía del gas ideal y la entropía residual.

\subsubsection{Entropía del gas ideal}

	El cálculo de la entropía segun el gas ideal, también necesita una ecuación que represente capacidad calorífica. En la sección \ref{sec:cp} se muestran las ecuaciónes de $C_p$ incluidas en la librería y como usarlas.

	En el fragmento de código \ref{lst:idealgasentropy} se muestra el cálculo de la entropía del gas ideal según la ecuación \ref{eq:idealgasentropy}. 

	\begin{lstlisting}[label={lst:idealgasentropy},caption={Cálculo de la entropía absoluta del gas ideal.}]
	double idealGasEntropy = homogeneous.calculateIdealGasEntropy();
	\end{lstlisting}

\subsubsection{Entropía real}

	El cálculo de la entalpía se realiza según la ecuación \ref{eq:entropy} y su uso se muestra en el código \ref{lst:entropy}.

\begin{lstlisting}[label={lst:entropy},caption={Cálculo de la entropía absoluta.}]
	double entropy = homogeneous.calculateEntropy()
\end{lstlisting}

	Las figuras \ref{fig:2dentropy} y \ref{fig:entropy3d} muestran diagramas de entalpía creados con ayuda de la librería \Materia.


\begin{figure}[!h]
	\centering	
	\begin{tikzpicture}
	\begin{axis}[xlabel={\entropy},ylabel=\pressure]
	\addplot[blue]table{plotdata/entropy/lv.dat};
	\end{axis}
	\end{tikzpicture}
	\caption{Diagrama de presión-entropía para el agua. Las líneas azules representan isotermas.}\label{fig:2dentropy}
\end{figure}


%	\begin{tikzpicture}
%	\begin{axis}[view/h=-45,xlabel={\entropy},ylabel={\molarVolume},zlabel={\pressure},colorbar]
%	\addplot3[surf,point meta=explicit]table[meta=temperature,x=pressure,y=entropy,z=temperature]{plotdata/entropy/lv3d.dat};
%	\addplot3[surf,point meta=explicit]table[meta=temperature,x=pressure,y=entropy,z=temperature]{plotdata/entropy/l3d.dat};
%	\addplot3[surf,point meta=explicit]table[meta=temperature,x=pressure,y=entropy,z=temperature]{plotdata/entropy/v3d.dat};
%	\end{axis}
%	\end{tikzpicture}

\begin{figure}[!h]
	\begin{tikzpicture}
	\begin{axis}[view/h=-165,xlabel={\entropy},ylabel={\molarVolume},zlabel={\pressure},colorbar,colorbar style={ylabel=Temperatura (K),title=Código de color}]
	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/lv3d.dat};
	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/l3d.dat};
	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/v3d.dat};
	\end{axis}
	\end{tikzpicture}
	% \begin{tikzpicture}
	% \begin{axis}[view/h=-225,xlabel={\entropy},ylabel={\molarVolume},zlabel={\pressure}]
	% \addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/lv3d.dat};
	% \addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/l3d.dat};
	% \addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/v3d.dat};
	% \end{axis}
	% \end{tikzpicture}
	% \begin{tikzpicture}
	% \begin{axis}[view/h=-120,xlabel={\entropy},ylabel={\molarVolume},zlabel={\pressure}]
	% \addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/lv3d.dat};
	% \addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/l3d.dat};
	% \addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/entropy/v3d.dat};
	% \end{axis}
	% \end{tikzpicture}
	\caption{Diagramas tridimensional presión-entropía-`volumen molar' para el agua.}\label{fig:entropy3d}
\end{figure}
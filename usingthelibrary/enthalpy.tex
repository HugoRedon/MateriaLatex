\subsection{Entalpía}\label{subsec:enthalpy}

	Para conocer la entalpía real de una substacia o mezcla, es necesario conocer la entalpía del gas ideal y la entalpía residual.

\subsubsection{Entalpía del gas ideal}
	Para realizar el cálculo de la entalpía segun el gas ideal, es necesaria una ecuación que represente la capacidad calorífica $C_p$. El cálculo depende de la forma de la ecuación y el valor de sus parámetros. En la sección \ref{sec:cp} se muestran las ecuaciónes de $C_p$ incluidas en la librería.

	Con la ecuación del $C_p$ la clase `Homogeneous' puede calcular la entalpía del gas ideal como se muestra en el código \ref{lst:idealgasenthalpy}.

	\begin{lstlisting}[label={lst:idealgasenthalpy},caption={Cálculo de la entalpía del gas ideal.}]
	double idealGasEnthalpy = homogeneous.calculateIdealGasEnthalpy():
	\end{lstlisting}
	
\subsubsection{Entalpía real}

	La entalpía residual no esta separada en un método particular dentro de la librería \Materia, sino que esta incluido en el cálculo de la entalpía real. Es muy facil realizar la separación, pero para los objetivos de la presente tesis no fue necesario realizarlo.

	El cálculo de la entalpía se realiza en el método `calculateEnthalpy()' como se muestra en el fragmento de código \ref{lst:enthalpy} según la ecuación \ref{eq:enthalpy}. 

\begin{lstlisting}[caption={Cálculo de la entalpía real para una mezcla o substancia homogénea.},label={lst:enthalpy}]
	double enthalpy = homogeneous.calculateEnthapy();
\end{lstlisting}
	
	Las figuras \ref{fig:2denthalpy} y \ref{fig:enthalpy3d} muestran líneas isotermas creadas con ayuda de la librería \Materia para el agua con la ecuación de Peng Robinson.

\begin{figure}[!h]
	\centering	
	\begin{tikzpicture}
	\begin{axis}[xlabel={\enthalpy},ylabel={\pressure}]
	\addplot[blue]table{plotdata/enthalpy/lv.dat};
	\end{axis}
	\end{tikzpicture}
	\caption{Diagrama de entalpía para el agua. Las líneas azules representan isotermas. Cálculos realizados con la ecuación de Peng Robinson para el agua.}\label{fig:2denthalpy}
\end{figure}


%\addplot+[point meta=explicit]table[x=xcolname,y=ycolname,meta=colordata]{datafile.dat};%ejemplo de uso meta
\begin{figure}[!h]
%\begin{tabular}{c c}
	\begin{tikzpicture}
		\begin{axis}[view/h=-165,
					xlabel={\enthalpy},
					ylabel={\molarVolume},
					zlabel={\pressure},
					colorbar,
					colorbar style={ylabel=Temperatura (K),
					 							title=Código de color}
					]
			\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/lv3d.dat};
			\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/l3d.dat};
			\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/v3d.dat};
		\end{axis}
	\end{tikzpicture}
	%&
% 	\begin{tikzpicture}
% 	\begin{axis}[view/h=-225,xlabel={\enthalpy},ylabel={\molarVolume},zlabel={\pressure}]
% 	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/lv3d.dat};
% 	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/l3d.dat};
% 	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/v3d.dat};
% 	\end{axis}
% 	\end{tikzpicture}
% %\\
%  %\multicolumn{2}{|c|}{
% 	\begin{tikzpicture}
% 	\begin{axis}[view/h=-120,xlabel={\enthalpy},ylabel={\molarVolume},zlabel={\pressure}]
% 	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/lv3d.dat};
% 	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/l3d.dat};
% 	\addplot3[surf,point meta=explicit]table[meta=temperature]{plotdata/enthalpy/v3d.dat};
% 	\end{axis}
% 	\end{tikzpicture}
%}
	\caption{Diagrama tridimensional presión-entalpía-`volumen molar' para el agua con la ecuación de Peng Robinson.}
	\label{fig:enthalpy3d}

%\end{tabular}
\end{figure}
\subsection{Temperatura de saturación}\label{subsec:saturationtemperature}


	El cálculo de temperatura de saturación se realiza como se indica en la figura \ref{fig:saturationtemperature}. Usando un objeto del tipo `HeterogeneousSubstance' de la librería \Materia el cálculo se realiza como se muestra en los fragmentos de código \ref{lst:saturationtemperature} y \ref{lst:saturationtemperatureWithEstimate}.

	Si al método no se le proporciona un estimado inicial, como se muestra en el código \ref{lst:saturationtemperature} entonces la clase realiza la estimación como se muestra en el diagrama \ref{fig:temperatureEstimate}. 


	\begin{lstlisting}[label={lst:saturationtemperatureWithEstimate},caption={Cálculo de la temperatura de saturación proporcionando un estimado inicial.}]
		heterogeneousSubstance.setPressure(pressure);
		heterogeneousSubstance.saturationTemperature(temperatureEstimate);
		double temperature = heterogeneousSubstance.getTemperature();
	\end{lstlisting}


	\begin{lstlisting}[label={lst:saturationtemperature},caption={Cálculo de la temperatura de saturación.}]
		heterogeneousSubstance.setPressure(pressure);
		heterogeneousSubstance.saturationTemperature();
		double temperature = heterogeneousSubstance.getTemperature();
	\end{lstlisting}

	

\begin{figure}[!h]
\begin{tikzpicture}[nodes={draw, fill=white,align=center},row sep=1.4cm,column sep=0.7cm] ]

\node(init){Inicio};
\node[below of=init,below] (lab)  {Lectura de \textbf{Datos} \\$P$};
\node[below of=lab,below = 0.4cm](estim){Estimado inicial de\\ la incognita\\$T$};
\node[below of=estim,below = 0.6](relations){Cálculo de la\\ razon de equilibrio\\
$K = \frac{ \hat{\phi}^L }{\hat{ \phi}^V}$};
\node[below of=relations,below = 0.6cm](error){Cálculo de la función Error\\$ E = \ln{K}$};

\node[below of=error,below = 0.6](criteria){$|E| \leq 1\cdot10^{-4}\quad \text{o} \quad  1\cdot 10^{-5}$};
\node[below of=criteria,below = 0.4](tempIncrement){Incrementar la temperatura\\$T^* = T + \Delta T$\\
$\Delta T = 0.1  \quad \text{o} \quad 1.0 K$};

\node[below of=tempIncrement,below = 0.4](relationsWithIncrement){Cálculo de las Razon\\ de Equilibrio con $T^*$
\\$K^* = \frac{ \hat{\phi}^L }{ \hat{\phi}^V}$};

\node[right of=criteria	,right=2.2cm](end){Fin};


\node[right of=tempIncrement, right=3cm](errorWithIncrement){Cálculo de la función Error \\ con $T^*$\\$ E^* = \ln{K^*}$};

\node[right of=relations, right = 3cm](newValues){Cálculo de la nueva estimación \\ de la \textbf{Incógnita}\\
\begin{minipage}{0.2\linewidth}
\begin{equation*}
T_{nueva} = \frac{TT^* \left(E^*-E\right)}{T^*E^*-TE}
\end{equation*}
\end{minipage}
};


\draw[-latex] (init)--(lab);
\draw[-latex] (lab)--(estim);
\draw[-latex] (estim)--(relations);
\draw[-latex] (relations)--(error);
\draw[-latex] (error)--(criteria);
\draw[-latex] (criteria)--node[fill=none,draw=none,above]{SI}(end);
\draw[-latex] (criteria)--node[fill=none,draw=none,left]{NO}(tempIncrement);
\draw[-latex] (tempIncrement)--(relationsWithIncrement);
\draw[-latex] (relationsWithIncrement)--(errorWithIncrement);
\draw[-latex] (errorWithIncrement)--(newValues);
\draw[-latex] (newValues)--(relations);

\end{tikzpicture}
\caption{Algoritmo de temperatura de saturación.}\label{fig:saturationtemperature}
\end{figure}










\begin{figure}[!h]
\begin{tikzpicture}[nodes={draw, fill=white,align=center},row sep=1.4cm,column sep=0.7cm] ]

\node(init){Inicio};
\node[below of=init,below] (lab)  {Lectura de \textbf{Datos} \\$P$};
\node[below of=lab,below = 0.4cm](estim){Estimado inicial de\\ la incognita\\$T=300 K$};
\node[below of=estim,below = 0.6](relations){Cálculo de la presión de vapor según\\ la ecuación del  factor acéntrico con $T$ \\\\
$ P\degree= P_c 10^{\displaystyle\left[\left(-\frac{7}{3}\right) \left(1+\omega \right)  \left(\left(\frac{T_c}{T}\right) - 1 \right) \right]}$};
\node[below of=relations,below = 1.1cm](error){Cálculo de la función Error\\$ E = \ln{\displaystyle\frac{P\degree}{P}}$};

\node[below of=error,below = 0.6](criteria){$|E| \leq 1\cdot10^{-4}\quad \text{o} \quad  1\cdot 10^{-5}$};
\node[below of=criteria,below = 0.4](tempIncrement){Incrementar la temperatura\\$T^* = T + \Delta T$\\
$\Delta T = 0.1  \quad \text{o} \quad 1.0 K$};

\node[below of=tempIncrement,below = 0.4](relationsWithIncrement){Cálculo de la presión de vapor según\\ la ecuación del factor acéntrico con $T^*$ \\\\
${P\degree}^*= P_c 10^{\displaystyle\left[\left(-\frac{7}{3}\right) \left(1+\omega \right)  \left(\left(\frac{T_c}{T^*}\right) - 1 \right) \right]}$};

\node[right of=criteria	,right=2.2cm](end){Fin};


\node[right of=tempIncrement, right=3cm](errorWithIncrement){Cálculo de la función Error\\$ E^* = \ln{\displaystyle\frac{{P\degree}^*}{P}}$};

\node[right of=relations, right = 3.5cm](newValues){Cálculo de la nueva estimación \\ de la \textbf{Incógnita}\\
\begin{minipage}{0.2\linewidth}
\begin{equation*}
T_{nueva} = \frac{TT^* \left(E^*-E\right)}{T^*E^*-TE}
\end{equation*}
\end{minipage}
};


\draw[-latex] (init)--(lab);
\draw[-latex] (lab)--(estim);
\draw[-latex] (estim)--(relations);
\draw[-latex] (relations)--(error);
\draw[-latex] (error)--(criteria);
\draw[-latex] (criteria)--node[fill=none,draw=none,above]{SI}(end);
\draw[-latex] (criteria)--node[fill=none,draw=none,left]{NO}(tempIncrement);
\draw[-latex] (tempIncrement)--(relationsWithIncrement);
\draw[-latex] (relationsWithIncrement)--(errorWithIncrement);
\draw[-latex] (errorWithIncrement)--(newValues);
\draw[-latex] (newValues)--(relations);

\end{tikzpicture}
\caption{Algoritmo de estimación de temperatura de saturación usando la ecuación del factor acéntrico.}
\label{fig:temperatureEstimate}
\end{figure}
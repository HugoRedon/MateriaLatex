\subsection{Factor de compresibilidad}\label{subsec:compresibilityFactor}



En el fragmento de código \ref{lst:compresibility} se muestra la creación de la ecuación de estado cúbica, adimensionalización de los parámetros y finalmente el cálculo de el factor de compresibilidad.

\begin{lstlisting}[label=lst:compresibility,caption={Cálculo del factor de compresibilidad, y adimensionamiento de los parámetros a y b con la clase ``Cubic''}]
Cubic cubic = EquationsOfState.vanDerWaals();
		
double criticalTemperature = 540.2;
double criticalPressure = 2.74000E+06;

double pressure = criticalPressure * 1.5;
double reducedTemperature= criticalTemperature * 2;

//parametros de van Der Waals para el heptano
double a = 3107000.0;
double b = 0.2049;

double A =cubic.get_A(temperature, pressure, a);
double B = cubic.get_B(temperature, pressure, b);

double z =cubic.calculateCompresibilityFactor(A, B, Phase.LIQUID);
\end{lstlisting}
 
	Para un rango de presión y a diferentes temperaturas podemos formar los diagramas de la figura \ref{fig:zchart}.

\begin{figure}
\begin{tabular}{c c}
	\begin{tikzpicture}
	\begin{axis}[width=0.45\linewidth,font=\footnotesize,view/v=-6,
		ylabel= {Presión reducida },
		xlabel= {Temperatura reducida},
		zlabel={Factor de compresibilidad z}]%[colormap/hot]
	\addplot3[surf,point meta=explicit] table[meta=rt,x=p,y=rt,z=z]{plotdata/compresibilitiChart/pz_temp.dat};
	\end{axis}
	\end{tikzpicture}
	&
	\begin{tikzpicture}
	\begin{axis}[width=0.45\linewidth,font=\footnotesize,
		xlabel= {Presión reducida },
		ylabel= {Factor de compresibilidad z}]%[colormap/hot]
	\addplot[blue]table{plotdata/compresibilitiChart/pz_temp.dat};
	\end{axis}
	\end{tikzpicture}
\end{tabular}
\caption{Diagramas del factor de compresibilidad }
\label{fig:zchart}
\end{figure}
